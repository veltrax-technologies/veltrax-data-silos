<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Veltrax | From Data Silos to Unified Intelligence</title>
    <meta name="description" content="Interactive simulator contrasting fragmented data silos with the Veltrax unified, on‑prem AI pipeline. Product‑aware with Finex, Échelon, and Verdict presets." />

    <!-- Tailwind (CDN build) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              vx: {
                bg: "#0f1115",
                surface: "#151822",
                text: "#E6E7EB",
                muted: "#9AA0AE",
                border: "#2C2F36",
                accent: "#6F42C1",
                good: "#22c55e",
                warn: "#f59e0b",
                bad: "#ef4444",
              },
            },
            keyframes: {
              pulseDot: {
                "0%, 100%": { transform: "scale(1)", opacity: 1 },
                "50%": { transform: "scale(0.7)", opacity: 0.5 },
              },
              flow: {
                "0%": { offsetDistance: "0%" },
                "100%": { offsetDistance: "100%" },
              },
              fadeInUp: {
                "0%": { opacity: 0, transform: "translateY(12px)" },
                "100%": { opacity: 1, transform: "translateY(0)" },
              },
              glow: {
                "0%": { boxShadow: "0 0 0 rgba(111,66,193,0)" },
                "100%": { boxShadow: "0 0 0 rgba(111,66,193,0)" },
              }
            },
            animation: {
              pulseDot: "pulseDot 1.6s ease-in-out infinite",
              fadeInUp: "fadeInUp .5s ease-out both",
            },
            boxShadow: {
              vx: "0 10px 30px rgba(0,0,0,.35)",
              focus: "0 0 0 2px rgba(111,66,193,.35)",
            },
          },
        },
      };
    </script>

    <style>
      .packet { offset-path: path(var(--p)); offset-rotate: 0deg; animation: flow var(--speed, 3500ms) linear infinite; }
      .legend-dot{ width:10px; height:10px; border-radius:999px; display:inline-block; margin-right:.5rem }
      .panel-active { opacity: 1; filter: none; box-shadow: 0 0 0 1px rgba(111,66,193,.35) inset, 0 0 24px rgba(111,66,193,.15); }
      .panel-inactive { opacity: .35; filter: grayscale(.2) saturate(.6); }
      ::-webkit-scrollbar{ height: 10px; width: 10px; }
      ::-webkit-scrollbar-thumb{ background:#2C2F36; border-radius:999px; }
      ::-webkit-scrollbar-track{ background:#131417; }
    </style>
  </head>
  <body class="bg-vx-bg text-vx-text selection:bg-vx-accent/30 selection:text-white">
    <!-- HERO -->
    <header class="relative overflow-hidden border-b border-vx-border/70 bg-gradient-to-b from-black/40 to-vx-bg">
      <div class="absolute inset-0 pointer-events-none" style="background: radial-gradient(1200px 400px at 50% -10%, rgba(111,66,193,.25), transparent 60%);"></div>
      <div class="max-w-7xl mx-auto px-6 md:px-10 py-16 md:py-24">
        <div class="flex items-center gap-3 opacity-90 animate-fadeInUp">
          <svg width="36" height="36" viewBox="0 0 64 64" fill="none" class="shrink-0">
            <rect x="6" y="10" width="52" height="12" rx="6" fill="white" />
            <rect x="6" y="30" width="42" height="12" rx="6" fill="white" />
            <rect x="6" y="50" width="26" height="8" rx="4" fill="#6F42C1" />
          </svg>
          <span class="tracking-widest text-xs text-vx-muted">VELTRAX</span>
        </div>
        <h1 class="mt-6 text-3xl md:text-5xl font-semibold leading-tight">From Data Silos to Unified Intelligence — Powered by Veltrax</h1>
        <p class="mt-4 text-vx-muted max-w-3xl">See how unifying your data under one secure, local AI unlocks real‑time insights and maximizes ROI.</p>

        <!-- Mode + Product Selector -->
        <div class="mt-8 flex flex-wrap items-center gap-3">
          <button id="modeCloud" class="px-4 py-2 rounded-xl border border-vx-border bg-vx-surface shadow-sm hover:border-vx-accent/50 transition">Cloud Providers</button>
          <button id="modeUnified" class="px-4 py-2 rounded-xl border border-vx-accent bg-vx-accent text-white shadow-vx">Veltrax Unified</button>
          <span class="text-vx-muted text-sm">Toggle to compare fragmented silos vs the unified Veltrax pipeline.</span>
        </div>

        <div class="mt-5 flex flex-wrap items-center gap-2">
          <span class="text-sm text-vx-muted mr-2">Preset:</span>
          <button data-product="finex" class="vx-prod px-3 py-1.5 rounded-lg border border-vx-accent/60 text-sm bg-vx-accent/20">Finex (Banking)</button>
          <button data-product="echelon" class="vx-prod px-3 py-1.5 rounded-lg border border-vx-border text-sm">Échelon (Retail)</button>
          <button data-product="verdict" class="vx-prod px-3 py-1.5 rounded-lg border border-vx-border text-sm">Verdict (Legal)</button>
        </div>
      </div>
    </header>

    <!-- MAIN -->
    <main class="max-w-7xl mx-auto px-6 md:px-10 grid grid-cols-1 lg:grid-cols-12 gap-8 mt-10 md:mt-14">
      <!-- Controls -->
      <section class="lg:col-span-4">
        <div class="rounded-2xl border border-vx-border bg-vx-surface shadow-sm">
          <div class="p-6 border-b border-vx-border/60">
            <h2 class="text-xl font-semibold">Data Source Selector</h2>
            <p class="text-sm text-vx-muted mt-1">Pick sources for the selected product. Veltrax will normalize them to a unified model.</p>
          </div>
          <div class="p-4 space-y-4">
            <div class="space-y-4" id="sourceList"></div>
            <div class="mt-5 p-4 rounded-xl bg-black/20 border border-vx-border/60">
              <div class="flex items-center justify-between mb-2">
                <span class="text-sm text-vx-muted">Daily volume multiplier</span>
                <span class="text-sm" id="volumeLabel">1.0×</span>
              </div>
              <input id="volume" type="range" min="0.5" max="5" step="0.1" value="1" class="w-full" />
              <p class="text-xs text-vx-muted mt-2">Simulates more or fewer events per day across selected sources.</p>
            </div>
          </div>
        </div>

        <div id="why" class="mt-6 rounded-2xl border border-vx-border bg-vx-surface/70 p-6 hidden">
          <h3 class="font-semibold">Why this matters</h3>
          <ul class="mt-2 text-sm text-vx-muted list-disc list-inside space-y-1">
            <li>Runs on your hardware. Private. No cloud dependency.</li>
            <li>All data, one source of truth. AI‑ready from day one.</li>
            <li>Unified schema reduces integration cost and latency.</li>
          </ul>
        </div>
      </section>

      <!-- Visualization: two separate panels side-by-side -->
      <section class="lg:col-span-8">
        <div class="rounded-2xl border border-vx-border bg-vx-surface overflow-hidden shadow-sm">
          <div class="p-6 border-b border-vx-border/60 flex items-center justify-between">
            <h2 class="text-xl font-semibold">Architectures Compared</h2>
            <div class="text-sm text-vx-muted">Left: Cloud / siloed • Right: Veltrax unified</div>
          </div>

          <div class="p-6 grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Cloud Silos Panel -->
            <div id="panelCloud" class="rounded-xl border border-vx-border/60 p-4 bg-black/20 transition-all">
              <div class="flex items-center justify-between mb-2">
                <h3 class="font-semibold">Cloud / On‑prem Silos</h3>
                <span class="text-xs text-vx-muted">Before</span>
              </div>
              <svg viewBox="0 0 520 320" class="w-full mt-2">
                <g id="cloudVendors" fill="none" stroke="#2C2F36" stroke-width="1.2"></g>
                <!-- No interconnections on purpose to highlight silos -->
              </svg>
              <p class="text-xs text-vx-muted mt-2">Disconnected systems. Joins happen downstream with duplicate logic and slow cross‑system queries.</p>
            </div>

            <!-- Veltrax Unified Panel -->
            <div id="panelUnified" class="rounded-xl border border-vx-border/60 p-4 bg-black/20 transition-all">
              <div class="flex items-center justify-between mb-2">
                <h3 class="font-semibold">Veltrax Unified Mapping</h3>
                <span class="text-xs text-vx-muted">After</span>
              </div>
              <svg viewBox="0 0 520 320" class="w-full mt-2">
                <!-- Left: Connectors (dynamic) -->
                <g id="leftConnectors" font-size="12" fill="#9AA0AE" stroke="#2C2F36" stroke-width="1.2"></g>
                <!-- Center: Unified Model -->
                <g>
                  <rect x="220" y="24" width="200" height="272" rx="16" fill="#0f1115" stroke="#6F42C1" stroke-width="2.2" />
                  <text x="320" y="48" text-anchor="middle" fill="#E6E7EB" font-size="13">Veltrax Unified Model</text>
                  <g fill="none" stroke="#2C2F36" stroke-width="1.2">
                    <rect x="240" y="70" width="160" height="38" rx="8" />
                    <rect x="240" y="118" width="160" height="38" rx="8" />
                    <rect x="240" y="166" width="160" height="38" rx="8" />
                    <rect x="240" y="214" width="160" height="38" rx="8" />
                  </g>
                  <g font-size="11" fill="#9AA0AE">
                    <text x="320" y="94" text-anchor="middle" id="u1">Entities</text>
                    <text x="320" y="142" text-anchor="middle" id="u2">Transactions</text>
                    <text x="320" y="190" text-anchor="middle" id="u3">Operations</text>
                    <text x="320" y="238" text-anchor="middle" id="u4">Risk / KPI</text>
                  </g>
                </g>
                <!-- Right: Products / Insights -->
                <g id="rightProducts" font-size="12" fill="#9AA0AE" stroke="#2C2F36" stroke-width="1.2">
                  <rect x="440" y="70" width="70" height="38" rx="8" />
                  <rect x="440" y="118" width="70" height="38" rx="8" />
                  <rect x="440" y="166" width="70" height="38" rx="8" />
                  <rect x="440" y="214" width="70" height="38" rx="8" />
                  <text x="475" y="94" text-anchor="middle" id="p1">KPIs</text>
                  <text x="475" y="142" text-anchor="middle" id="p2">AI</text>
                  <text x="475" y="190" text-anchor="middle" id="p3">Reports</text>
                  <text x="475" y="238" text-anchor="middle" id="p4">APIs</text>
                </g>
                <g id="flows" stroke="#6F42C1" stroke-width="2" fill="none"></g>
                <g id="packets"></g>
              </svg>
              <div class="text-xs text-vx-muted flex flex-wrap items-center gap-4 mt-2">
                <div><span class="legend-dot" style="background:#6F42C1"></span>Unified stream</div>
                <div><span class="legend-dot" style="background:#22c55e"></span>Validated → products</div>
                <div><span class="legend-dot" style="background:#9AA0AE"></span>Source connectors</div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- METRICS -->
    <section class="max-w-7xl mx-auto px-6 md:px-10 mt-8 mb-16">
      <div class="rounded-2xl border border-vx-border bg-vx-surface shadow-sm">
        <div class="p-6 border-b border-vx-border/60">
          <h2 class="text-xl font-semibold">Processing Speed & Efficiency</h2>
          <p class="text-sm text-vx-muted mt-1">Updates with your product preset, sources, and volume.</p>
        </div>
        <div class="p-4 grid grid-cols-2 md:grid-cols-4 gap-4" id="metrics"></div>
      </div>
      <div class="mt-4 text-xs text-vx-muted"><span class="opacity-80">Note:</span> Simulated metrics illustrate the relative impact of a unified schema vs siloed feeds.</div>
    </section>

    <!-- FOOTER (clean, no product links) -->
    <footer class="border-t border-vx-border/70 py-10">
      <div class="max-w-7xl mx-auto px-6 md:px-10 flex flex-col md:flex-row items-start md:items-center justify-between gap-6">
        <div>
          <div class="flex items-center gap-3">
            <svg width="28" height="28" viewBox="0 0 64 64" fill="none" class="shrink-0">
              <rect x="6" y="10" width="52" height="12" rx="6" fill="white" />
              <rect x="6" y="30" width="42" height="12" rx="6" fill="white" />
              <rect x="6" y="50" width="26" height="8" rx="4" fill="#6F42C1" />
            </svg>
            <span class="tracking-widest text-xs text-vx-muted">VELTRAX</span>
          </div>
          <p class="text-sm text-vx-muted mt-3 max-w-xl">Local‑first. Private by default. Built for operators who need provable ROI.</p>
          <a class="text-vx-accent hover:underline mt-2 block" href="https://www.linkedin.com/company/veltrax-technologies/?viewAsMember=true" target="_blank" rel="noopener">Connect with us on LinkedIn</a>
        </div>
      </div>
    </footer>

    <!-- SCRIPT -->
    <script>
      // Presets
      const PRESETS = {
        finex: {
          name: 'Finex (Banking)',
          sources: [
            { key: 'core', name: 'Core Banking (Jack Henry, FIS, Fiserv)', baseRps: 420, roi: 2.0 },
            { key: 'loans', name: 'Loan Systems (nCino, custom LOS)', baseRps: 160, roi: 1.5 },
            { key: 'cards', name: 'Cards & Payments (ISO8583, RTP, ACH)', baseRps: 300, roi: 1.6 },
            { key: 'crm', name: 'CRM (Salesforce)', baseRps: 120, roi: 1.1 },
            { key: 'files', name: 'CSV / Excel / SFTP drops', baseRps: 90, roi: 0.9 },
          ],
          ulabels: ['Customers/Accounts','Transactions','Operations','Risk / KPI'],
          plabels: ['KPIs','Fraud Engine','Reports','APIs']
        },
        echelon: {
          name: 'Échelon (Retail)',
          sources: [
            { key: 'pos', name: 'POS / ERP (NCR, Oracle, Lightspeed)', baseRps: 320, roi: 1.6 },
            { key: 'inventory', name: 'Inventory / WMS', baseRps: 180, roi: 1.3 },
            { key: 'ecom', name: 'E‑commerce (Shopify, Magento)', baseRps: 220, roi: 1.4 },
            { key: 'crm', name: 'CRM / Loyalty', baseRps: 140, roi: 1.1 },
            { key: 'files', name: 'CSV / Excel / Local DB', baseRps: 80, roi: 0.9 },
          ],
          ulabels: ['Products/Stores','Sales/Orders','Ops/Staffing','Shrink / KPI'],
          plabels: ['KPIs','Demand AI','Reports','Action API']
        },
        verdict: {
          name: 'Verdict (Legal)',
          sources: [
            { key: 'dms', name: 'Doc Mgmt (iManage, NetDocs)', baseRps: 160, roi: 1.2 },
            { key: 'ecf', name: 'Court Filings (ECF/PACER)', baseRps: 110, roi: 1.3 },
            { key: 'billing', name: 'Billing / Timekeeping', baseRps: 130, roi: 1.1 },
            { key: 'crm', name: 'CRM / Matters', baseRps: 100, roi: 1.0 },
            { key: 'files', name: 'PDF / Email / Local DB', baseRps: 70, roi: 0.9 },
          ],
          ulabels: ['Clients/Matters','Docs/Exhibits','Deadlines','Risk / KPI'],
          plabels: ['Case KPIs','LLM','Reports','Hooks']
        },
      };

      const PIPELINES = {
        cloud:   { eff: 0.42,  batchLatency: 1800, aiLatency: 480 },
        unified: { eff: 0.88,  batchLatency: 600,  aiLatency: 120 },
      };

      const DOLLAR_PER_1K_ROWS = 4.2;
      const ROI_MULTIPLIER = 1.0;

      const state = { mode: 'unified', volume: 1.0, product: 'finex', enabled: new Set() };

      const $modeCloud = document.getElementById('modeCloud');
      const $modeUnified = document.getElementById('modeUnified');
      const $volume = document.getElementById('volume');
      const $volumeLabel = document.getElementById('volumeLabel');
      const $sourceList = document.getElementById('sourceList');
      const $metrics = document.getElementById('metrics');
      const $why = document.getElementById('why');

      const $panelCloud = document.getElementById('panelCloud');
      const $panelUnified = document.getElementById('panelUnified');

      const $left = () => document.getElementById('leftConnectors');
      const $flows = () => document.getElementById('flows');
      const $packets = () => document.getElementById('packets');
      const $vendors = () => document.getElementById('cloudVendors');

      function activePreset(){ return PRESETS[state.product]; }

      function buildSources(){
        $sourceList.innerHTML = '';
        state.enabled = new Set(activePreset().sources.map(s=>s.key));
        activePreset().sources.forEach(s => {
          const row = document.createElement('div');
          row.className = 'grid grid-cols-8 items-center gap-3 rounded-xl border border-vx-border/60 p-3';
          row.innerHTML = `
            <div class="col-span-6">
              <label class="flex items-center gap-3">
                <input type="checkbox" class="peer sr-only" data-key="${s.key}" checked />
                <span class="h-5 w-9 rounded-full bg-black/30 border border-vx-border/60 relative inline-flex items-center"><i class="dot h-3 w-3 bg-white rounded-full absolute left-1 transition-transform"></i></span>
                <span class="ml-2">${s.name}</span>
              </label>
            </div>
            <div class="col-span-2 text-right"><span class="text-xs text-vx-muted">~${s.baseRps.toLocaleString()} rows/s</span></div>`;
          const cb = row.querySelector('input');
          const dot = row.querySelector('.dot');
          cb.addEventListener('change', (e)=>{
            const key = e.target.getAttribute('data-key');
            if (e.target.checked) state.enabled.add(key); else state.enabled.delete(key);
            dot.style.transform = e.target.checked ? 'translateX(16px)' : 'translateX(0)';
            render();
          });
          dot.style.transform = 'translateX(16px)';
          $sourceList.appendChild(row);
        });
      }

      function buildMetrics({ rps, batchLatency, aiLatency, dailyROI }){
        $metrics.innerHTML = '';
        const items = [
          { label: 'Throughput', value: `${Math.round(rps).toLocaleString()} rows/sec` },
          { label: 'Batch latency', value: `${Math.round(batchLatency)} ms` },
          { label: 'AI decision latency', value: `${Math.round(aiLatency)} ms` },
          { label: 'Projected daily ROI', value: `$${Math.round(dailyROI).toLocaleString()}` },
        ];
        items.forEach(m=>{
          const card = document.createElement('div');
          card.className = 'rounded-xl border border-vx-border/60 bg-black/20 p-4';
          card.innerHTML = `<div class="text-xs text-vx-muted">${m.label}</div><div class="mt-1 text-xl font-semibold">${m.value}</div>`;
          $metrics.appendChild(card);
        });
      }

      function totals(){
        const cfg = PIPELINES[state.mode];
        const preset = activePreset();
        const active = preset.sources.filter(s => state.enabled.has(s.key));
        const baseRps = active.reduce((sum,s)=>sum+s.baseRps,0);
        const rps = baseRps * state.volume * cfg.eff;
        const aiLatency = cfg.aiLatency * (1 / cfg.eff);
        const batchLatency = cfg.batchLatency * (1 / cfg.eff);
        const rowsPerDay = rps * 86400;
        const roiFactor = active.reduce((acc,s)=>acc + s.roi, 0) / Math.max(active.length,1);
        const dailyROI = (rowsPerDay/1000) * DOLLAR_PER_1K_ROWS * roiFactor * cfg.eff * ROI_MULTIPLIER;
        return { rps, aiLatency, batchLatency, dailyROI };
      }

      function drawCloudSilos(){
        const g = $vendors(); g.innerHTML = '';
        const cols = [20, 200, 380];
        const rows = [30, 100, 170, 240];
        const labels = ['AWS','Azure','GCP','DB','CRM','ERP','Files','Payments'];
        let i=0;
        rows.forEach(y=>{
          cols.forEach(x=>{
            if (i>=labels.length) return; const w=92, h=44;
            const r = document.createElementNS('http://www.w3.org/2000/svg','rect');
            r.setAttribute('x', x); r.setAttribute('y', y); r.setAttribute('width', w); r.setAttribute('height', h); r.setAttribute('rx', 10);
            r.setAttribute('fill', '#0f1115'); r.setAttribute('stroke', '#2C2F36');
            const t = document.createElementNS('http://www.w3.org/2000/svg','text');
            t.setAttribute('x', x + w/2); t.setAttribute('y', y + 26); t.setAttribute('text-anchor','middle'); t.setAttribute('fill','#9AA0AE'); t.textContent = labels[i++];
            g.appendChild(r); g.appendChild(t);
          });
        });
        // no connecting lines, by design
      }

      function drawUnified(){
        // Left connectors boxes + labels
        const preset = activePreset();
        const left = $left(); left.innerHTML = '';
        const startX = 20, startY = 60, w = 180, h = 34, gap = 12;
        preset.sources.forEach((s, i)=>{
          if (!state.enabled.has(s.key)) return;
          const y = startY + i*(h+gap);
          const rect = document.createElementNS('http://www.w3.org/2000/svg','rect');
          rect.setAttribute('x', startX); rect.setAttribute('y', y);
          rect.setAttribute('width', w); rect.setAttribute('height', h); rect.setAttribute('rx', 8);
          rect.setAttribute('fill', '#0f1115'); rect.setAttribute('stroke', '#2C2F36');
          rect.setAttribute('title', s.name);
          const label = document.createElementNS('http://www.w3.org/2000/svg','text');
          label.setAttribute('x', startX + w/2); label.setAttribute('y', y + 22); label.setAttribute('text-anchor','middle');
          label.setAttribute('fill','#9AA0AE'); label.textContent = s.name;
          left.appendChild(rect); left.appendChild(label);
        });

        // Right products labels
        const [p1,p2,p3,p4] = activePreset().plabels;
        document.getElementById('p1').textContent = p1;
        document.getElementById('p2').textContent = p2;
        document.getElementById('p3').textContent = p3;
        document.getElementById('p4').textContent = p4;

        // Unified bucket labels
        const [u1,u2,u3,u4] = activePreset().ulabels;
        document.getElementById('u1').textContent = u1;
        document.getElementById('u2').textContent = u2;
        document.getElementById('u3').textContent = u3;
        document.getElementById('u4').textContent = u4;

        // Flow paths
        const flows = $flows(); const packets = $packets();
        flows.innerHTML=''; packets.innerHTML='';
        const mapIndex = (key)=>{
          const m = { core:0, loans:1, cards:1, crm:0, files:2, pos:1, inventory:2, ecom:1, dms:1, ecf:2, billing:2 };
          return Math.min(m[key] ?? 2, 3);
        };
        const leftEdge = 200; const busX = 220; const bucketYs = [90, 138, 186, 234];
        let i=0;
        activePreset().sources.forEach(s=>{
          if (!state.enabled.has(s.key)) return;
          const sy = 77 + i*(46); i++;
          const by = bucketYs[mapIndex(s.key)];
          const d = `M ${leftEdge} ${sy} C ${leftEdge+20} ${sy}, ${busX-20} ${by}, ${busX} ${by}`;
          const path = document.createElementNS('http://www.w3.org/2000/svg','path');
          path.setAttribute('d', d); path.setAttribute('stroke','#6F42C1'); path.setAttribute('stroke-width','2.2'); path.setAttribute('fill','none');
          flows.appendChild(path);
          const g = document.createElementNS('http://www.w3.org/2000/svg','g');
          g.setAttribute('class','packet'); g.style.setProperty('--p', `'${d}'`); g.style.setProperty('--speed', `${3200 - (i%4)*250}ms`);
          const c = document.createElementNS('http://www.w3.org/2000/svg','circle'); c.setAttribute('r','4'); c.setAttribute('fill','#6F42C1'); c.setAttribute('class','animate-pulseDot');
          g.appendChild(c); packets.appendChild(g);
        });

        // Outgoing to products
        const outLines = [
          'M 400 90 C 430 90, 430 90, 440 90',
          'M 400 138 C 430 130, 430 130, 440 138',
          'M 400 186 C 430 180, 430 180, 440 186',
          'M 400 234 C 430 234, 430 234, 440 234',
        ];
        outLines.forEach((d, idx)=>{
          const p = document.createElementNS('http://www.w3.org/2000/svg','path');
          p.setAttribute('d', d); p.setAttribute('stroke','#22c55e'); p.setAttribute('stroke-width','2.2'); p.setAttribute('fill','none');
          flows.appendChild(p);
          const g = document.createElementNS('http://www.w3.org/2000/svg','g');
          g.setAttribute('class','packet'); g.style.setProperty('--p', `'${d}'`); g.style.setProperty('--speed', `${2800 + idx*180}ms`);
          const c = document.createElementNS('http://www.w3.org/2000/svg','circle'); c.setAttribute('r','3.8'); c.setAttribute('fill','#22c55e'); c.setAttribute('class','animate-pulseDot');
          g.appendChild(c); packets.appendChild(g);
        });
      }

      function applyPanelFocus(){
        if (state.mode === 'cloud'){
          $panelCloud.classList.add('panel-active');
          $panelCloud.classList.remove('panel-inactive');
          $panelUnified.classList.remove('panel-active');
          $panelUnified.classList.add('panel-inactive');
        } else {
          $panelUnified.classList.add('panel-active');
          $panelUnified.classList.remove('panel-inactive');
          $panelCloud.classList.remove('panel-active');
          $panelCloud.classList.add('panel-inactive');
        }
      }

      function render(){
        // Toggles
        if (state.mode === 'cloud'){
          $modeCloud.className = 'px-4 py-2 rounded-xl border border-vx-accent bg-vx-accent text-white shadow-vx';
          $modeUnified.className = 'px-4 py-2 rounded-xl border border-vx-border bg-vx-surface shadow-sm hover:border-vx-accent/50 transition';
          document.getElementById('why').classList.add('hidden');
        } else {
          $modeUnified.className = 'px-4 py-2 rounded-xl border border-vx-accent bg-vx-accent text-white shadow-vx';
          $modeCloud.className = 'px-4 py-2 rounded-xl border border-vx-border bg-vx-surface shadow-sm hover:border-vx-accent/50 transition';
          document.getElementById('why').classList.remove('hidden');
        }
        // Metrics
        buildMetrics(totals());
        // Diagrams
        drawCloudSilos();
        drawUnified();
        applyPanelFocus();
      }

      function bindProductButtons(){
        document.querySelectorAll('.vx-prod').forEach(btn=>{
          btn.addEventListener('click', ()=>{
            document.querySelectorAll('.vx-prod').forEach(b=>b.className='vx-prod px-3 py-1.5 rounded-lg border border-vx-border text-sm');
            btn.className='vx-prod px-3 py-1.5 rounded-lg border border-vx-accent/60 text-sm bg-vx-accent/20';
            state.product = btn.getAttribute('data-product');
            buildSources();
            render();
          });
        });
      }

      function init(){
        bindProductButtons();
        buildSources();
        $modeCloud.addEventListener('click', ()=>{ state.mode='cloud'; render(); });
        $modeUnified.addEventListener('click', ()=>{ state.mode='unified'; render(); });
        $volume.addEventListener('input', (e)=>{ state.volume = parseFloat(e.target.value); $volumeLabel.textContent = `${state.volume.toFixed(1)}×`; render(); });
        render();
      }

      document.addEventListener('DOMContentLoaded', init);
    </script>
  </body>
</html>
